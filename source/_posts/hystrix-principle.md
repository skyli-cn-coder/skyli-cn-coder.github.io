---
title: 菜鸟浅谈Hystrix
date: 2018-08-15 22:12:45
categories: 微服务
tags: [高可用]
---
## Hystrix是什么？
 Hystrix 是[Netflix](https://www.netflix.com/)为了预防服务间因某个服务故障导致整个系统雪崩而设计的高可用服务容错框架！有点抽象？往下看。。。

## Hystrix要解决的问题？
 **应用背景:**
 在复杂的分布式系统架构中，服务间复杂的依赖关系，而每个服务的可用性不能得到充足的保证，如果服务没有和自己的依赖服务进行隔离，那么可能某一个依赖服务的故障就会拖垮当前这个服务。
 Hystrix就是通过响应策略阻止当前服务被拖垮的一个容错框架！

**有点抽象？看下图。。。**
![服务依赖](https://raw.githubusercontent.com/lz330718637/Images/master/20190131145652.png)
任何应用（或者说任何服务）通常是部署在一个web容器中供外部用户调用，常见的web容器：大家最熟悉的Tomcat或者Weblogic、Jboss、Jetty等。
外部用户的每次调用，web容器都将启动一个线程去处理请求。
举个栗子：
月底到了，小明（用户请求）的工作任务没有完成，小明需要在两天时间内完成A、H、I、P四个任务（服务）！！！
正常情况下，如果时间安排妥当且中间不出现问题的话，那小明能够很轻松的完成目标任务。万事大吉。。。阿弥陀佛。。。

但是事情总没有想象的那么完美，完成任务I中间出现了一些问题。导致小明没有完成，但是小明不知道是什么原因，他没有放弃，一直尝试着完成任务I。。。。
![服务依赖](https://raw.githubusercontent.com/lz330718637/Images/master/20190131145732.png)
就这样，小明将剩余的两天时间全部用在了解决任务I（web容器启动其他线程去调用服务），但一直没有完成，两天的时间用完了（web容器的线程资源用完了）。。。。
最终小明被领导痛批了一顿，差点丢了工作（整个系统差点雪崩）！
![服务依赖](https://raw.githubusercontent.com/lz330718637/Images/master/20190131145810.png)
发现这个例子不咋地（尴尬。。。）还是用比较正式的话描述一下吧：
上面三张图表示通常在服务调用中从最开始的正常调用，到出现一个调用异常（调用方没有获取依赖服务I的响应，当前线程卡住，则线程资源得不到释放，如果这对该服务的并发访问比较高的话，其他线程资源都会来调用该服务）最后所有的进程资源全部用来访问该服务而导致资源耗尽从而使当前服务崩溃，最后可能整个分布式系统的雪崩！